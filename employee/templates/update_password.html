{% extends "base.html" %}
{% block title %}Change Password{% endblock %}
{% block content %}

<div class="container mt-5" style="max-width: 500px;">
  <h3 class="text-center mb-4">Change Password</h3>

  <div class="card shadow-sm p-4">
    <form method="post" novalidate>
      {% csrf_token %}

      <div class="mb-3 position-relative">
        <label class="form-label fw-semibold">Old Password</label>
        {{ form.old_password }}
        <i class="bi bi-eye toggle-password" style="position:absolute; right:15px; top:40px; cursor:pointer;"></i>
        {% for error in form.old_password.errors %}
          <div class="text-danger small mt-1">{{ error }}</div>
        {% endfor %}
      </div>

      <div class="mb-3 position-relative">
        <label class="form-label fw-semibold">New Password</label>
        {{ form.new_password1 }}
        <i class="bi bi-eye toggle-password" style="position:absolute; right:15px; top:40px; cursor:pointer;"></i>
        {% for error in form.new_password1.errors %}
          <div class="text-danger small mt-1">{{ error }}</div>
        {% endfor %}
      </div>

      <div class="mb-3 position-relative">
        <label class="form-label fw-semibold">Confirm New Password</label>
        {{ form.new_password2 }}
        <i class="bi bi-eye toggle-password" style="position:absolute; right:15px; top:40px; cursor:pointer;"></i>
        {% for error in form.new_password2.errors %}
          <div class="text-danger small mt-1">{{ error }}</div>
        {% endfor %}
      </div>

      {% if form.non_field_errors %}
      <div class="alert alert-danger mt-3" role="alert">
        {% for error in form.non_field_errors %}
          <div>{{ error }}</div>
        {% endfor %}
      </div>
      {% endif %}

      <button type="submit" class="btn btn-primary w-100 mt-2">Update Password</button>
    </form>
  </div>
</div>

<script>
  document.querySelectorAll('.toggle-password').forEach(icon => {
    icon.addEventListener('click', () => {
      const input = icon.previousElementSibling;
      if (input.type === 'password') {
        input.type = 'text';
        icon.classList.replace('bi-eye', 'bi-eye-slash');
      } else {
        input.type = 'password';
        icon.classList.replace('bi-eye-slash', 'bi-eye');
      }
    });
  });
</script>

<style>
  input {
    border-radius: 0.5rem;
    padding: 0.5rem 2.5rem 0.5rem 0.75rem;
    width: 100%;
  }
  .form-label {
    margin-bottom: 0.3rem;
  }
</style>

{% endblock %}
